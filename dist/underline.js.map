{"version":3,"sources":["../src/underline.js"],"names":[],"mappings":"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","file":"underline.js","sourcesContent":["\"use strict\";\n\n(function ($) {\n    $.fn.underline = function (initTimeOut = 100) {\n\n        var underlineItems = [];\n        this.each(function (index, item) {\n            underlineItems.push(new UnderlineItem(item));\n        });\n        setTimeout(function () {\n            underlineItems.forEach(function (item) {\n                item.init();\n            });\n        }, initTimeOut);\n    };\n\n    class UnderlineItem {\n        constructor(element) {\n            this.element = element;\n            this.defineWords();\n            this.defineContainer();\n        }\n\n        init() {\n            $(window).resize(() => this.refresh());\n            this.refresh();\n        }\n\n        refresh() {\n            $('canvas', this.element).remove();\n            this.fixContainer();\n            this.processElement();\n            this.removeTmpLine();\n            this.unfixContainer();\n        }\n\n        fixContainer() {\n            $(this.container).css('height', window.getComputedStyle(this.container, null).getPropertyValue(\"height\"));\n        }\n\n        unfixContainer() {\n            this.container.style.height = this.containerOldStyles.height;\n        }\n\n        defineWords() {\n            this.words = this.element.textContent.replace(/\\n/g, ' ').match(/[^\\s-]+-?\\s?/g);\n        }\n\n        defineContainer() {\n            this.container = this.element;\n            while (!(window.getComputedStyle(this.container, null).getPropertyValue(\"display\") == 'block' && window.getComputedStyle(this.container, null).getPropertyValue(\"position\") == 'relative') && this.container.parentNode.nodeName !== 'HTML') {\n                this.container = this.container.parentNode;\n            }\n            this.containerOldStyles = {\n                height: this.container.style.height\n            };\n        }\n\n        createTmpLine() {\n            this.tmpLine = document.createElement('span');\n            this.tmpLine.className = 'tmp-line';\n            $(this.element).prepend(this.tmpLine);\n        }\n\n        removeTmpLine() {\n            $(this.tmpLine).remove();\n        }\n\n        processElement() {\n            var computedHeight;\n            var words = this.words.slice(0);\n            this.element.innerText = '';\n            this.createTmpLine();\n\n            do {\n                this.tmpLine.innerText = words[0];\n                computedHeight = this.tmpLine.getBoundingClientRect().height;\n                for (var i = 0; i <= words.length; i++) {\n                    this.tmpLine.innerText = words.slice(0, i).join('');\n                    if (Math.floor(this.tmpLine.getBoundingClientRect().height) > Math.floor(computedHeight)) {\n                        this.tmpLine.innerText = words.splice(0, i - 1).join('');\n                        this.generateUnderline();\n                        break;\n                    } else if (words.length == i) {\n                        this.tmpLine.innerText = words.splice(0, i).join('');\n                        this.generateUnderline();\n                    }\n                }\n            } while (words.length > 0);\n        }\n\n        generateUnderline() {\n            var underline = new Underline(this.tmpLine);\n            underline.createLine();\n            underline.createHoles();\n            $(this.tmpLine.childNodes).insertBefore(this.tmpLine);\n        }\n    }\n\n    class Underline {\n        constructor(element) {\n            this.element = element;\n            this.defineOffsets();\n            this.defineStyles();\n\n            this.text = this.element.textContent;\n            this.createCanvas();\n\n            this.defineCanvasStyles();\n        }\n\n        createCanvas() {\n            this.canvas = document.createElement(\"canvas\");\n            this.ctx = this.canvas.getContext('2d');\n\n            if (!window.devicePixelRatio) {\n                window.devicePixelRatio = window.screen.deviceXDPI / window.screen.logicalXDPI;\n            }\n            this.ratio = window.devicePixelRatio;\n            this.canvas.width = this.styles.width * this.ratio;\n            this.canvas.height = this.styles.height * this.ratio;\n\n            this.canvas.style.top = this.element.offsetTop + 'px';\n            this.canvas.style.left = this.element.offsetLeft + 'px';\n            this.canvas.style.width = this.styles.width + 'px';\n            this.canvas.style.position = 'absolute';\n            this.canvas.style.zIndex = '-1';\n\n            this.element.appendChild(this.canvas);\n        }\n\n        createLine() {\n            this.textWidth = this.ctx.measureText(this.text).width;\n            if (this.ration > 1) {\n                this.textWidth *= this.ratio;\n            }\n\n            this.startPoint = { x: 0, y: this.underlinePosition };\n            this.endPoint = { x: this.textWidth, y: this.underlinePosition };\n\n            this.maxGrabDistance = this.strokeWidth * 2;\n            this.maxControlDistance = this.strokeWidth * 6;\n\n            this.ctx.lineWidth = this.strokeWidth;\n            this.ctx.strokeStyle = this.styles.fontColor;\n\n            this.ctx.beginPath();\n            this.ctx.moveTo(this.startPoint.x, this.startPoint.y);\n            this.ctx.lineTo(this.endPoint.x, this.endPoint.y);\n            this.ctx.globalCompositeOperation = \"source-over\";\n            this.ctx.stroke();\n        }\n\n        createHoles() {\n            // draw the font stroke\n            this.ctx.font = this.font;\n            this.ctx.textBaseline = 'top';\n\n            this.ctx.globalCompositeOperation = \"destination-out\";\n\n            this.ctx.lineWidth = 2 * this.ratio + this.strokeWidth*(this.styles.fontSize.replace('px', '')/16);\n            //this.ctx.lineWidth = 2 * this.ratio + this.strokeWidth * 3.6;\n            this.ctx.strokeStyle = 'blue';\n            this.ctx.beginPath();\n            var adjustY = navigator.userAgent.toLowerCase().indexOf('firefox') > -1 ? this.ctx.canvas.scrollHeight * 0.1 : 0;\n\n            this.ctx.strokeText(this.text, -0.2, adjustY);\n\n            this.ctx.fillStyle = 'transparent';\n            this.ctx.beginPath();\n            this.ctx.fillText(this.text, -0.2, adjustY);\n        }\n\n        defineOffsets() {\n            this.offsetTop = 0;\n            this.offsetLeft = 0;\n\n            var element = this.element;\n\n            while (!(window.getComputedStyle(element, null).getPropertyValue(\"display\") == 'block' && window.getComputedStyle(element, null).getPropertyValue(\"position\") == 'relative' || element.parentNode.nodeName == 'BODY')) {\n                this.offsetTop += element.offsetTop;\n                this.offsetLeft += element.offsetLeft;\n                element = element.parentNode;\n            }\n        }\n\n        defineCanvasStyles() {\n            this.ctx.font = this.font = this.styles.fontStyle + ' ' + this.multiplyValue(this.styles.fontSize, this.ratio) + ' ' + this.styles.fontFamily;\n\n            // determine the text-underline-width / strokeWidth\n            var dotWidth = this.ctx.measureText('.')['width'];\n\n            this.strokeWidth = dotWidth / 12;\n\n            this.strokeColor = this.styles.fontColor;\n\n            // determine the text-underline-position / underlinePosition\n            // text-underline-position in ratio, todo: default and user set position ratio\n            this.underlinePosition = parseFloat(this.styles.height) * this.ratio * (1 - this.styles.baselinePositionRatio + this.styles.baselinePositionRatio * 0.4) + this.strokeWidth / 2;\n\n            var adjustValue = this.optimalStrokeWidthPos(this.strokeWidth, this.underlinePosition);\n            this.strokeWidth = adjustValue.strokeWidth;\n            this.underlinePosition = adjustValue.posY;\n        }\n\n        defineStyles() {\n            this.styles = {\n                baselinePositionRatio: this.baselineRatio(),\n                lineHeight: parseFloat(window.getComputedStyle(this.element, null).getPropertyValue(\"line-height\")),\n                fontFamily: window.getComputedStyle(this.element, null).getPropertyValue(\"font-family\"),\n                fontSize: window.getComputedStyle(this.element, null).getPropertyValue(\"font-size\"),\n                fontColor: window.getComputedStyle(this.element, null).getPropertyValue(\"color\"),\n                fontStyle: window.getComputedStyle(this.element, null).getPropertyValue(\"font-style\"),\n                width: this.element.getBoundingClientRect().width,\n                height: this.element.getBoundingClientRect().height,\n                parentWidth: this.element.parentNode.getBoundingClientRect().width,\n                offsetLeft: this.element.offsetLeft\n            };\n        }\n\n        baselineRatio() {\n            // Get the baseline in the context of whatever element is passed in.\n            var element = this.element || document.body;\n\n            // The container is a little defenseive.\n            var container = document.createElement('div');\n            container.style.display = \"block\";\n            container.style.position = \"absolute\";\n            container.style.bottom = \"0\";\n            container.style.right = \"0\";\n            container.style.width = \"0px\";\n            container.style.height = \"0px\";\n            container.style.margin = \"0\";\n            container.style.padding = \"0\";\n            container.style.visibility = \"hidden\";\n            container.style.overflow = \"hidden\";\n\n            // Intentionally unprotected style definition.\n            var small = document.createElement('span');\n            var large = document.createElement('span');\n\n            // Large numbers help improve accuracy.\n            small.style.fontSize = \"0px\";\n            large.style.fontSize = \"2000px\";\n\n            small.innerHTML = \"X\";\n            large.innerHTML = \"X\";\n\n            container.appendChild(small);\n            container.appendChild(large);\n\n            // Put the element in the DOM for a split second.\n            element.appendChild(container);\n            var smalldims = small.getBoundingClientRect();\n            var largedims = large.getBoundingClientRect();\n            element.removeChild(container);\n\n            // Calculate where the baseline was, percentage-wise.\n            var baselineposition = smalldims.top - largedims.top;\n            var height = largedims.height;\n\n            return 1 - baselineposition / height;\n        }\n\n        optimalStrokeWidthPos(strokeWidth, posY) {\n            if (strokeWidth < 1) {\n                posY = Math.round(posY - 0.5) + 0.5;\n            } else if (strokeWidth >= 1) {\n                strokeWidth = Math.round(strokeWidth);\n                if (strokeWidth % 2) {\n                    // odd, posY -> 0.5\n                    posY = Math.round(posY - 0.5) + 0.5;\n                } else {\n                    // even, posY -> 1\n                    posY = Math.round(posY);\n                }\n            }\n            return {\n                strokeWidth: strokeWidth,\n                posY: posY\n            };\n        }\n\n        multiplyValue(value, multiplier) {\n            var str = value;\n            var m = multiplier;\n            var result = str.match(/(\\d*\\.?\\d*)(.*)/);\n            //http://stackoverflow.com/questions/2868947/split1px-into-1px-1-px-in-javascript\n            return result[1] * m + result[2];\n        }\n\n    }\n})(jQuery);\n\n//# sourceMappingURL=underline.js.map\n\n//# sourceMappingURL=underline.js.map"]}